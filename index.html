<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SpinChoice.io</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  margin: 0;
  background: #f4f6f9;
}
#container {
  position: relative;
  width: 90vmin;
  max-width: 500px;
}
canvas {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  display: block;
}
#pointer {
  width: 0;
  height: 0;
  border-left: 25px solid transparent;
  border-right: 25px solid transparent;
  border-top: 45px solid #e63946; /* downward pointer */
  position: absolute;
  top: -45px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
}
button {
  margin-top: 20px;
  padding: 12px 22px;
  font-size: 16px;
  font-weight: 600;
  color: white;
  background: #457b9d;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s;
}
button:hover { background: #1d3557; }
#winner {
  margin-top: 15px;
  font-size: 20px;
  font-weight: 600;
  color: #333;
}
</style>
</head>
<body>
<div id="container">
  <div id="pointer"></div>
  <canvas id="wheel" width="600" height="600"></canvas>
</div>
<button id="spinBtn">Spin!</button>
<p id="winner"></p>

<script>
const sequence = ["Devin","Tommy","Dom","Jimmy","Alex","Tim C","Noah S","Lorcan","Hisham","Tim R","Noah R","Nick"];

// shuffle helper
function shuffle(array) {
  let a = [...array];
  for (let i=a.length-1; i>0; i--) {
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

let remaining = shuffle(sequence);
let spinStep = 0;
let isSpinning = false;
let lastWinner = null;

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const spinBtn = document.getElementById("spinBtn");
const winnerEl = document.getElementById("winner");

function drawWheel() {
  const size = canvas.width;
  const radius = size/2;
  const slices = remaining.length;
  const sliceAngle = 2*Math.PI/slices;
  ctx.clearRect(0,0,size,size);
  for (let i=0;i<slices;i++) {
    ctx.beginPath();
    ctx.moveTo(radius,radius);
    ctx.arc(radius,radius,radius,i*sliceAngle,(i+1)*sliceAngle);
    ctx.fillStyle = i % 2 === 0 ? "#a8dadc" : "#dee2e6"; // alternating flat UI colors
    ctx.fill();
    ctx.strokeStyle = "#fff";
    ctx.lineWidth = 2;
    ctx.stroke();

    ctx.save();
    ctx.translate(radius,radius);
    ctx.rotate(i*sliceAngle + sliceAngle/2);
    ctx.textAlign="right";
    ctx.fillStyle="#222";
    ctx.font="18px Segoe UI";
    ctx.fillText(remaining[i], radius-12, 5);
    ctx.restore();
  }
}

drawWheel();

function spinWheel() {
  if (isSpinning || remaining.length===0) return;

  // remove last winner before new spin
  if (lastWinner) {
    const idx = remaining.indexOf(lastWinner);
    if (idx !== -1) remaining.splice(idx,1);
    lastWinner = null;
    drawWheel();
  }

  isSpinning = true;
  winnerEl.textContent = ""; // clear display until spin ends

  const slices = remaining.length;
  const sliceAngle = 360/slices;
  const winnerName = sequence[spinStep];
  const winnerIndex = remaining.indexOf(winnerName);

  // rotation so winner slice aligns with pointer (top = 270Â°)
  const stopAngle = 360*5 + (270 - (winnerIndex*sliceAngle + sliceAngle/2));

  let start=null;
  const duration = 4500;
  function animate(timestamp){
    if(!start) start=timestamp;
    const progress = Math.min((timestamp-start)/duration,1);
    const eased = 1-Math.pow(1-progress,3);
    const angle = stopAngle*eased;
    canvas.style.transform = `rotate(${angle}deg)`;

    if(progress<1){
      requestAnimationFrame(animate);
    } else {
      winnerEl.textContent = winnerName + " was picked!";
      lastWinner = winnerName;
      spinStep++;
      isSpinning=false;
      if(remaining.length===1 && spinStep>=sequence.length) {
        spinBtn.disabled=true;
      }
    }
  }
  requestAnimationFrame(animate);
}

spinBtn.addEventListener("click",spinWheel);
</script>
</body>
</html>
