<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SpinChoice – Name Picker</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>SpinChoice – Name Picker</header>
  <main>
    <div class="container">
      <h2>Name Picker</h2>
      <div id="wheelContainer" style="position: relative; display: flex; flex-direction: column; align-items: center;">
        <div id="arrow"></div>
        <canvas id="wheel" width="400" height="400"></canvas>
      </div>
      <button id="spin">Spin</button>
      <div id="winner"></div>
    </div>
  </main>

  <script>
    const canvas = document.getElementById("wheel");
    const ctx = canvas.getContext("2d");
    const winnerDisplay = document.getElementById("winner");
    const spinButton = document.getElementById("spin");

    // Start with empty names (user must edit via code or URL)
    let names = [];

    // Default fallback demo names (optional, delete if you want truly blank)
    if (names.length === 0) {
      names = ["Alice","Bob","Charlie","Diana"];
    }

    let rotation = 0;
    let spinning = false;

    function drawWheel() {
      if (names.length === 0) return;
      const R = canvas.width/2;
      const slice = (2 * Math.PI) / names.length;

      ctx.clearRect(0,0,canvas.width,canvas.height);

      names.forEach((name, i) => {
        const a0 = rotation + i * slice;
        const a1 = a0 + slice;

        ctx.beginPath();
        ctx.moveTo(R,R);
        ctx.arc(R,R,R,a0,a1);
        ctx.closePath();
        ctx.fillStyle = i % 2 === 0 ? "#f1f3f6" : "#dfe6ee";
        ctx.fill();

        ctx.save();
        ctx.translate(R,R);
        ctx.rotate(a0 + slice/2);
        ctx.fillStyle = "#333";
        ctx.font = "16px Segoe UI";
        ctx.textAlign = "right";
        ctx.fillText(name, R-10, 5);
        ctx.restore();
      });
    }

    function spinRandom() {
      if (spinning || names.length === 0) return;
      spinning = true;
      winnerDisplay.textContent = "";

      const winnerIndex = Math.floor(Math.random() * names.length);
      const slice = (2 * Math.PI) / names.length;
      const targetAngle = (3 * Math.PI / 2) - (winnerIndex * slice + slice/2);
      const spins = 5;
      const finalRotation = spins*2*Math.PI + targetAngle;

      let start=null;
      const duration=3000;

      function animate(ts){
        if(!start) start=ts;
        const p=Math.min((ts-start)/duration,1);
        rotation = finalRotation*(1-Math.pow(1-p,3));
        drawWheel();

        if(p<1){ requestAnimationFrame(animate); }
        else {
          rotation = finalRotation;
          drawWheel();
          winnerDisplay.textContent = "Winner: " + names[winnerIndex];
          spinning=false;
        }
      }
      requestAnimationFrame(animate);
    }

    spinButton.addEventListener("click", spinRandom);
    drawWheel();
  </script>
</body>
</html>
